======================================================================
DEVICE CONFIGURATION
======================================================================
Using device: cuda

======================================================================
DATASET LOADING AND PREPERATION
======================================================================
Loading MNIST dataset...

Dataset Summary:
---------------------------------------------
Dataset                         Size
---------------------------------------------
Train set                     60,000
Test set                      10,000
Labeled data                  48,000
Unlabeled data                10,000
Validation data                2,000
Discarded/Unused data              0
---------------------------------------------

Metadata Information:
---------------------------------------------
Property                  Value
---------------------------------------------
Number of classes         10
Input shape               (1, 28, 28)
Feature dimension         784
Flattened shape           torch.Size([784])
---------------------------------------------

======================================================================
DOWNSTREAM MODEL INITIALIZATION
======================================================================
Initializing downstream model: resnet18

======================================================================
TRAINING LOOP
======================================================================
Starting training with PyTorch agent...
Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.6500%.
Episode 1: Final Reward = -11.8470, New Accuracy = 93.3500, Error Rate = 6.6500, policy Loss = -0.3544, Value Loss = 0.0294

New best error rate: 6.6500% - Saving models...
Downstream model saved to /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_downstream.pth
Policy gradient models saved to /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_policy_gradient_policy.pth and /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_policy_gradient_value.pth
Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.6500%.
Episode 2: Final Reward = -8.6570, New Accuracy = 92.3500, Error Rate = 7.6500, policy Loss = 0.5768, Value Loss = 0.0668

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 5.8000%.
Episode 3: Final Reward = -8.0485, New Accuracy = 94.2000, Error Rate = 5.8000, policy Loss = 0.2139, Value Loss = 0.0112

New best error rate: 5.8000% - Saving models...
Downstream model saved to /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_downstream.pth
Policy gradient models saved to /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_policy_gradient_policy.pth and /home/g49199003/Desktop/capstone/fall-2025-group11/src/component/trained_models_resnet18_mnist/best_policy_gradient_value.pth
Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.7500%.
Episode 4: Final Reward = -8.1580, New Accuracy = 92.2500, Error Rate = 7.7500, policy Loss = -0.0665, Value Loss = 0.0025

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.0000%.
Episode 5: Final Reward = -8.1705, New Accuracy = 94.0000, Error Rate = 6.0000, policy Loss = -0.1963, Value Loss = 0.0080

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.7500%.
Episode 6: Final Reward = -7.5380, New Accuracy = 93.2500, Error Rate = 6.7500, policy Loss = -0.2302, Value Loss = 0.0101

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.7000%.
Episode 7: Final Reward = -7.8675, New Accuracy = 93.3000, Error Rate = 6.7000, policy Loss = -0.2406, Value Loss = 0.0110

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.3500%.
Episode 8: Final Reward = -7.7340, New Accuracy = 93.6500, Error Rate = 6.3500, policy Loss = -0.2053, Value Loss = 0.0081

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.9000%.
Episode 9: Final Reward = -6.9995, New Accuracy = 93.1000, Error Rate = 6.9000, policy Loss = -0.1672, Value Loss = 0.0057

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.1500%.
Episode 10: Final Reward = -7.0520, New Accuracy = 92.8500, Error Rate = 7.1500, policy Loss = -0.1603, Value Loss = 0.0053

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.7500%.
Episode 11: Final Reward = -6.1580, New Accuracy = 93.2500, Error Rate = 6.7500, policy Loss = -0.1032, Value Loss = 0.0025

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.0000%.
Episode 12: Final Reward = -6.3805, New Accuracy = 93.0000, Error Rate = 7.0000, policy Loss = -0.0802, Value Loss = 0.0019

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.9000%.
Episode 13: Final Reward = -6.3195, New Accuracy = 92.1000, Error Rate = 7.9000, policy Loss = -0.0704, Value Loss = 0.0016

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.4500%.
Episode 14: Final Reward = -6.1750, New Accuracy = 92.5500, Error Rate = 7.4500, policy Loss = -0.0469, Value Loss = 0.0012

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.7000%.
Episode 15: Final Reward = -5.8775, New Accuracy = 92.3000, Error Rate = 7.7000, policy Loss = -0.0223, Value Loss = 0.0007

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.3500%.
Episode 16: Final Reward = -5.8740, New Accuracy = 92.6500, Error Rate = 7.3500, policy Loss = -0.0110, Value Loss = 0.0006

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.0500%.
Episode 17: Final Reward = -5.8510, New Accuracy = 91.9500, Error Rate = 8.0500, policy Loss = -0.0023, Value Loss = 0.0006

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.6000%.
Episode 18: Final Reward = -5.2665, New Accuracy = 91.4000, Error Rate = 8.6000, policy Loss = 0.0388, Value Loss = 0.0009

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 6.8500%.
Episode 19: Final Reward = -5.2090, New Accuracy = 93.1500, Error Rate = 6.8500, policy Loss = 0.0681, Value Loss = 0.0016

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.9000%.
Episode 20: Final Reward = -5.3995, New Accuracy = 92.1000, Error Rate = 7.9000, policy Loss = 0.0762, Value Loss = 0.0017

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.7500%.
Episode 21: Final Reward = -4.6280, New Accuracy = 92.2500, Error Rate = 7.7500, policy Loss = 0.1002, Value Loss = 0.0024

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.8000%.
Episode 22: Final Reward = -4.5085, New Accuracy = 92.2000, Error Rate = 7.8000, policy Loss = 0.0788, Value Loss = 0.0016

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.4500%.
Episode 23: Final Reward = -4.7150, New Accuracy = 90.5500, Error Rate = 9.4500, policy Loss = 0.0643, Value Loss = 0.0013

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.2000%.
Episode 24: Final Reward = -4.0225, New Accuracy = 92.8000, Error Rate = 7.2000, policy Loss = 0.0994, Value Loss = 0.0025

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.0500%.
Episode 25: Final Reward = -3.4010, New Accuracy = 92.9500, Error Rate = 7.0500, policy Loss = 0.1262, Value Loss = 0.0035

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.0000%.
Episode 26: Final Reward = -3.2105, New Accuracy = 93.0000, Error Rate = 7.0000, policy Loss = 0.0986, Value Loss = 0.0022

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.5000%.
Episode 27: Final Reward = -3.2555, New Accuracy = 91.5000, Error Rate = 8.5000, policy Loss = 0.0581, Value Loss = 0.0010

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.3000%.
Episode 28: Final Reward = -3.3435, New Accuracy = 92.7000, Error Rate = 7.3000, policy Loss = 0.0206, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.9000%.
Episode 29: Final Reward = -3.0895, New Accuracy = 91.1000, Error Rate = 8.9000, policy Loss = -0.0081, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.9000%.
Episode 30: Final Reward = -2.8495, New Accuracy = 91.1000, Error Rate = 8.9000, policy Loss = -0.0215, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.6000%.
Episode 31: Final Reward = -2.3665, New Accuracy = 92.4000, Error Rate = 7.6000, policy Loss = -0.0183, Value Loss = 0.0003

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.9000%.
Episode 32: Final Reward = -2.6795, New Accuracy = 92.1000, Error Rate = 7.9000, policy Loss = -0.0295, Value Loss = 0.0005

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 7.8500%.
Episode 33: Final Reward = -1.9390, New Accuracy = 92.1500, Error Rate = 7.8500, policy Loss = -0.0265, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.4500%.
Episode 34: Final Reward = -1.8750, New Accuracy = 91.5500, Error Rate = 8.4500, policy Loss = -0.0305, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.8500%.
Episode 35: Final Reward = -2.0190, New Accuracy = 90.1500, Error Rate = 9.8500, policy Loss = -0.0293, Value Loss = 0.0004

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.0500%.
Episode 36: Final Reward = -1.8910, New Accuracy = 90.9500, Error Rate = 9.0500, policy Loss = -0.0152, Value Loss = 0.0003

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.6500%.
Episode 37: Final Reward = -1.5970, New Accuracy = 91.3500, Error Rate = 8.6500, policy Loss = -0.0021, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.1500%.
Episode 38: Final Reward = -1.3420, New Accuracy = 91.8500, Error Rate = 8.1500, policy Loss = 0.0175, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.7500%.
Episode 39: Final Reward = -1.4280, New Accuracy = 90.2500, Error Rate = 9.7500, policy Loss = 0.0220, Value Loss = 0.0003

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.0500%.
Episode 40: Final Reward = -1.4110, New Accuracy = 91.9500, Error Rate = 8.0500, policy Loss = 0.0116, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.0000%.
Episode 41: Final Reward = -1.2105, New Accuracy = 92.0000, Error Rate = 8.0000, policy Loss = 0.0174, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.5000%.
Episode 42: Final Reward = -0.9355, New Accuracy = 90.5000, Error Rate = 9.5000, policy Loss = 0.0131, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.7500%.
Episode 43: Final Reward = -0.7680, New Accuracy = 91.2500, Error Rate = 8.7500, policy Loss = 0.0067, Value Loss = 0.0001

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.5000%.
Episode 44: Final Reward = -0.7155, New Accuracy = 90.5000, Error Rate = 9.5000, policy Loss = -0.0037, Value Loss = 0.0001

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.8000%.
Episode 45: Final Reward = -0.9685, New Accuracy = 91.2000, Error Rate = 8.8000, policy Loss = -0.0213, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 8.7500%.
Episode 46: Final Reward = -1.0080, New Accuracy = 91.2500, Error Rate = 8.7500, policy Loss = -0.0284, Value Loss = 0.0003

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 10.8500%.
Episode 47: Final Reward = -0.6190, New Accuracy = 89.1500, Error Rate = 10.8500, policy Loss = -0.0153, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 11.1000%.
Episode 48: Final Reward = -0.6415, New Accuracy = 88.9000, Error Rate = 11.1000, policy Loss = -0.0184, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.8500%.
Episode 49: Final Reward = -0.5290, New Accuracy = 90.1500, Error Rate = 9.8500, policy Loss = -0.0145, Value Loss = 0.0002

Initial (Episode-Start) Error Rate on Validation Data: 9.95%
Episode Terminated. Final Error Rate: 9.0000%.
Episode 50: Final Reward = -0.5605, New Accuracy = 91.0000, Error Rate = 9.0000, policy Loss = -0.0105, Value Loss = 0.0001

======================================================================
FINAL RESULTS
======================================================================
Training finished. Best error rate achieved: 5.8000%
